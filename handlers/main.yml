---
- name: clear auth_Linux
  file: path='{{ install_dir }}/{{ nifi_dir_name }}/conf/{{ item }}' state=absent
  with_items:
    - users.xml
    - authorizations.xml
  ignore_errors: true

- name: clear auth_Windows
  win_file: path='{{ install_dir }}\\{{ nifi_dir_name }}\\conf\\{{ item }}' state=absent
  with_items:
    - users.xml
    - authorizations.xml
  ignore_errors: true

- name: install nifi_Linux
  command: "{{ install_dir }}/{{ nifi_dir_name }}/bin/nifi.sh install"

- name: install nifi_Windows 
  win_nssm: name=NifiService application='{{ install_dir }}\\{{ nifi_dir_name }}\\bin\\run-nifi.bat' state=present start_mode=manual

- name: restart nifi_Linux
  service: name=nifi state=restarted

- name: restart nifi_Windows
  win_service: name=NifiService state=restarted


